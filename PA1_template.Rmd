---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Setup

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(magrittr)
library(grid)
library(gridExtra)
```

## Loading and preprocessing the data

```{r}
activity <- read_csv("activity.zip")
```

Inspect the data set

```{r}
str(activity)
```

## What is mean total number of steps taken per day?

Calculate the total number of steps per day

```{r}
steps_per_day<-activity%<>%
  drop_na()%>%
  group_by(date)%>%
  summarise(total_steps=sum(steps))
```

Plot histogram of total number of steps taken each day

```{r}
steps_per_day%>%
  ggplot()+
  geom_histogram(aes(total_steps), fill="white", color="black")+
  labs(x="total number of steps per day")
```

Calculate the mean and median of the total number of steps taken per day

```{r}
steps_per_day%<>%
  summarise(mean_steps=mean(total_steps),
            median_steps=median(total_steps))
```

**Conclustion**: The median number of steps taken per day was
`r steps_per_day$median_steps`. The mean number of steps taken per day
was `r steps_per_day$mean_steps`.

## What is the average daily activity pattern?

Visualize the daily activity pattern, including the average number of steps taken, averaged across all days
```{r}
activity%>%
  drop_na()%>%
  ggplot(aes(x=interval, y=steps))+
  geom_line(aes(group=date))+
  stat_summary(fun = mean, color="red", geom = "line", size=3)
```

Calculate the average daily activity
```{r}
daily_activity<-
  activity%>%
  drop_na()%>%
  group_by(interval)%>%
  summarise(average_step=mean(steps))
```

Visualize the average daily activity pattern
```{r}
daily_activity%>%
  ggplot(aes(x=interval, y=average_step))+
  geom_line()
```
Which 5-minute interval contains the maximum number of steps? 
```{r}
max(daily_activity)
```


## Imputing missing values

## Are there differences in activity patterns between weekdays and weekends?
